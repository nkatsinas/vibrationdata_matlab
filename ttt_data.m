ttt=[20	0.00078269	0.00081724	0.0016319
24.942	0.0007777	0.00083337	0.0016626
30.175	0.00077001	0.00085556	0.0017046
35.409	0.00075871	0.00088401	0.0017582
40.643	0.00074184	0.00092028	0.0018262
45.877	0.00071596	0.00096685	0.0019127
50.633	0.00067922	0.0010216	0.0020135
54.777	0.00062955	0.0010836	0.0021261
58.255	0.00056677	0.0011511	0.0022475
61.084	0.00049536	0.0012223	0.002374
63.328	0.00042841	0.001294	0.0025001
65.072	0.00039008	0.0013613	0.0026171
66.406	0.00040928	0.0014178	0.0027133
67.415	0.00050059	0.0014578	0.0027786
68.17	0.00064851	0.0014801	0.0028113
68.731	0.00081709	0.0014887	0.0028193
69.147	0.00097436	0.0014894	0.002814
69.453	0.0011047	0.0014867	0.0028037
69.679	0.0012056	0.0014831	0.002793
69.844	0.001281	0.0014798	0.0027838
69.965	0.0013364	0.0014771	0.0027764
70.053	0.0013768	0.001475	0.0027707
70.118	0.0014061	0.0014734	0.0027665
70.294	0.001484	0.0014689	0.0027547
70.469	0.0015592	0.0014643	0.0027426
70.534	0.0015862	0.0014626	0.0027382
70.605	0.0016146	0.0014608	0.0027335
70.624	0.0016221	0.0014603	0.0027322
70.746	0.0016694	0.0014574	0.0027243
70.914	0.0017299	0.0014537	0.0027139
71.144	0.001804	0.0014495	0.0027014
71.459	0.0018877	0.0014459	0.0026882
71.891	0.0019685	0.0014457	0.0026789
72.484	0.0020227	0.001455	0.0026837
72.549	0.0020253	0.0014566	0.0026854
73.296	0.0020209	0.0014827	0.0027181
74.037	0.0019765	0.0015169	0.0027666
74.408	0.0019469	0.0015348	0.0027929
75.161	0.0018818	0.0015661	0.0028407
75.934	0.0018149	0.0015808	0.0028668
76.003	0.0018091	0.0015807	0.0028673
76.629	0.0017586	0.0015661	0.0028533
77.092	0.0017237	0.0015367	0.0028184
77.434	0.0016995	0.0015041	0.0027785
77.685	0.0016825	0.0014745	0.0027419
77.869	0.0016704	0.0014501	0.0027118
78.004	0.0016618	0.001431	0.0026881
78.025	0.0016605	0.001428	0.0026843
78.103	0.0016557	0.0014165	0.0026701
78.175	0.0016512	0.0014056	0.0026566
78.371	0.0016394	0.0013751	0.0026191
78.566	0.001628	0.0013436	0.0025804
78.639	0.0016238	0.0013319	0.002566
78.69	0.0016209	0.0013236	0.002556
78.739	0.0016182	0.0013157	0.0025463
78.875	0.0016107	0.0012936	0.0025194
79.062	0.0016006	0.0012637	0.0024834
79.319	0.0015873	0.0012242	0.0024364
79.67	0.00157	0.0011746	0.0023784
80.152	0.0015478	0.0011175	0.0023145
80.812	0.0015201	0.0010624	0.0022589
81.717	0.0014866	0.0010271	0.0022372
82.958	0.0014479	0.0010315	0.002278
84.659	0.0014054	0.0010876	0.0024003
86.849	0.0013642	0.001191	0.0026003
86.99	0.0013619	0.0011982	0.002614
90.186	0.0013215	0.0013699	0.0029425
93.956	0.0012924	0.0015976	0.0033863
94.566	0.0012891	0.001638	0.0034661
99.921	0.0012719	0.0020625	0.0043143
100	0.0012718	0.00207	0.0043292
100.57	0.0012837	0.0021465	0.0044851
104.77	0.0013787	0.0028462	0.0059121
108.62	0.0014766	0.003799	0.0078587
108.8	0.0014813	0.0038532	0.0079694
111.61	0.0015607	0.0048821	0.010073
113.9	0.0016305	0.006009	0.012375
115.63	0.0016871	0.0070624	0.014524
116.93	0.0017319	0.0079479	0.016325
117.89	0.0017667	0.0086342	0.017714
118.6	0.0017934	0.0091431	0.01874
119.13	0.0018136	0.0095152	0.019486
119.52	0.0018287	0.0097873	0.020031
119.8	0.0018399	0.0099871	0.020429
120.01	0.0018482	0.010134	0.020722
120.08	0.0018511	0.010187	0.020828
120.16	0.0018542	0.010243	0.020938
120.27	0.0018587	0.010322	0.021096
120.57	0.0018709	0.010541	0.02153
120.87	0.0018832	0.010767	0.021978
120.98	0.0018877	0.010852	0.022148
121.14	0.001894	0.010972	0.022385
121.35	0.0019027	0.011141	0.02272
121.63	0.0019146	0.011383	0.0232
121.92	0.0019263	0.011635	0.023699
122.03	0.001931	0.011739	0.023906
122.57	0.0019535	0.012283	0.024987
123.31	0.0019843	0.013157	0.026727
124.33	0.0020256	0.014642	0.029697
124.42	0.0020291	0.01479	0.029993
125.72	0.0020778	0.017268	0.03496
126.31	0.0020969	0.018563	0.037559
127.63	0.0021294	0.021754	0.043964
127.72	0.002131	0.021981	0.044418
128.77	0.0021403	0.024478	0.049425
129.55	0.0021359	0.026027	0.052523
130.13	0.0021264	0.02687	0.054203
130.25	0.0021238	0.027005	0.054471
130.55	0.0021163	0.027277	0.055008
130.86	0.0021074	0.027444	0.055334
131.08	0.0021003	0.027492	0.055422
131.25	0.0020947	0.027486	0.055403
131.37	0.0020906	0.027459	0.055344
131.7	0.0020789	0.027292	0.054995
132.03	0.0020668	0.026988	0.05437
132.15	0.0020623	0.026841	0.054071
132.32	0.0020561	0.026613	0.053604
132.55	0.0020478	0.026249	0.052862
132.86	0.0020369	0.025661	0.051668
133.29	0.0020231	0.024711	0.04974
133.88	0.0020074	0.023199	0.046677
134.69	0.0019931	0.020891	0.042009
135.8	0.0019886	0.017642	0.035446
137.32	0.0020076	0.013611	0.027315
139.41	0.0020657	0.0093831	0.018798
142.27	0.0021758	0.0057098	0.01141
146.19	0.0023473	0.0030462	0.0060628
151.56	0.0025965	0.001396	0.0027605
158.92	0.002959	0.00051451	0.0010064
169.01	0.0035097	0.00013901	0.0002706
182.84	0.0044054	0.000098096	0.00020896
185.62	0.0046099	0.00011892	0.00025463
201.79	0.0060125	0.0003572	0.0007555
209.52	0.00684	0.00053649	0.001127
227.78	0.0093748	0.0011792	0.00245
231.24	0.0099741	0.0013489	0.0027981
250.17	0.01424	0.0027519	0.0056681
266.05	0.01979	0.005142	0.010541
278.97	0.026618	0.0091234	0.018637
289.22	0.034498	0.015439	0.031454
297.18	0.043	0.02463	0.050078
303.28	0.051582	0.03638	0.07385
307.88	0.059723	0.049072	0.099497
311.33	0.067033	0.060471	0.1225
313.9	0.073299	0.069101	0.13988
315.79	0.07847	0.074807	0.15136
317.19	0.082611	0.07824	0.15825
318.22	0.08585	0.080181	0.16213
318.98	0.088339	0.081235	0.16423
319.53	0.090225	0.081791	0.16533
319.93	0.091641	0.082078	0.16589
320.23	0.092696	0.082221	0.16616
321.03	0.095636	0.082327	0.16634
321.83	0.098714	0.082018	0.16568
322.13	0.09989	0.0818	0.16523
322.54	0.10153	0.081412	0.16443
323.1	0.10385	0.08072	0.163
323.86	0.10713	0.079486	0.16048
324.91	0.11188	0.077313	0.15604
326.35	0.11886	0.073597	0.14848
328.33	0.12943	0.067576	0.13626
330.8	0.14454	0.059434	0.11976
331.03	0.14609	0.058658	0.11819
334.74	0.17393	0.047084	0.094771
339.82	0.22449	0.034426	0.069194
339.91	0.22547	0.034251	0.068841
346.79	0.32698	0.023019	0.046185
346.87	0.32853	0.022914	0.045972
352.14	0.43952	0.01762	0.035316
356.09	0.53888	0.014933	0.029923
356.34	0.54546	0.014791	0.029638
359.02	0.61385	0.013473	0.027
361.19	0.66322	0.012625	0.025305
362.79	0.69277	0.012098	0.024254
363.97	0.70936	0.011752	0.023565
364.83	0.71828	0.011516	0.023095
365.46	0.72292	0.011351	0.022767
365.93	0.72526	0.011234	0.022533
366.26	0.72639	0.01115	0.022365
367.18	0.72698	0.010928	0.021922
368.1	0.72396	0.010711	0.02149
368.44	0.72193	0.010632	0.021332
368.91	0.71838	0.010524	0.021116
369.54	0.7121	0.010377	0.020822
370.42	0.70102	0.010176	0.02042
371.62	0.68165	0.0099007	0.019867
373.27	0.6487	0.009521	0.019104
375.53	0.59555	0.0089961	0.018048
378.62	0.51707	0.0082797	0.016602
382.86	0.41544	0.0073428	0.014709
388.67	0.30428	0.0062112	0.012422
396.64	0.20315	0.0049803	0.0099351
407.57	0.1255	0.0037779	0.00751
422.54	0.073254	0.0027093	0.0053596
443.06	0.04115	0.0018326	0.0036002
471.19	0.022488	0.0011615	0.0022589
500	0.013836	0.00077325	0.0014866
509.75	0.011583	0.00065756	0.0012588
562.6	0.0050216	0.0002906	0.00054197
635.05	0.0019768	0.00010421	0.00018566
707.5	0.00088506	0.000039288	0.000066905
779.95	0.00042283	0.000016561	0.000029253
852.4	0.00020806	0.000010357	0.000022536
924.85	0.00010354	0.000010978	0.000028064
997.3	0.000052406	0.000014392	0.000038202
1069.7	0.000028611	0.000018817	0.000049667
1142.2	0.000019333	0.000023448	0.00006103
1214.6	0.000017902	0.000027921	0.000071693
1287.1	0.000020703	0.000032085	0.000081442
1359.5	0.000025719	0.000035889	0.000090238
1432	0.000031804	0.000039329	0.000098125
1504.4	0.000038298	0.000042427	0.00010518
1576.9	0.000044825	0.00004521	0.00011148
1649.3	0.000051173	0.00004771	0.00011713
1721.8	0.000057228	0.000049958	0.00012218
1794.2	0.000062935	0.000051983	0.00012672
1866.7	0.000068273	0.00005381	0.00013081
1939.1	0.000073243	0.000055461	0.0001345
2000	0.000077142	0.000056728	0.00013733];


ttt1=[ttt(:,1) ttt(:,2)];
ttt2=[ttt(:,1) ttt(:,3)];
ttt3=[ttt(:,1) ttt(:,4)];

mpe=[   20.0 	0.002298  
   31.6 	 0.01423  
   68.1 	0.002441  
  124.4 	0.0003992  
 2000.0 	0.003959  ];



input_psd_m_6dB=[ 20 	    0.0016 
       100 	    0.0016 
       500 	    0.0255 
      2000 	    0.0255];
  
  
input_psd_m_9dB=[          20 	    0.0008 
       100 	    0.0008 
       500 	   0.01275 
      2000 	   0.01275 ];
  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
  
df=1;
s=0;

f=input_psd_m_6dB(:,1);
a=input_psd_m_6dB(:,2);
[fi,ai] = interpolate_log(f,a,s,df);
clear input_psd_m_6dB;
input_psd_m_6dB(:,1)=fi;
input_psd_m_6dB(:,2)=ai;


f=input_psd_m_9dB(:,1);
a=input_psd_m_9dB(:,2);
[fi,ai] = interpolate_log(f,a,s,df);
clear input_psd_m_9dB;
input_psd_m_9dB(:,1)=fi;
input_psd_m_9dB(:,2)=ai;

f=mpe(:,1);
a=mpe(:,2);
[fi,ai] = interpolate_log(f,a,s,df);
clear mpe;
mpe(:,1)=fi;
mpe(:,2)=ai;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

n=length(ttt3(:,1));

trans1=zeros(n,2);
trans2=zeros(n,2);
trans3=zeros(n,2);


%%

gg=input_psd_m_6dB(:,1);
bb=input_psd_m_6dB(:,2);

for i=1:n
    ff=ttt3(i,1);
    aa=ttt3(i,2);
    [~,inx] = min(abs(ff-gg));
    trans3(i,:)=[ff aa/bb(inx)];
end    

%%

gg=input_psd_m_9dB(:,1);
bb=input_psd_m_9dB(:,2);

for i=1:n
    ff=ttt2(i,1);
    aa=ttt2(i,2);
    [~,inx] = min(abs(ff-gg));
    trans2(i,:)=[ff aa/bb(inx)];
end 

%%
for i=1:n
    ff=ttt1(i,1);
    aa=ttt1(i,2);
    [~,inx] = min(abs(ff-gg));
    trans1(i,:)=[ff aa/bb(inx)];
end 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

trans_max=zeros(n,2);

trans_max(:,1)=trans1(:,1);

for i=1:n
    trans_max(i,2)=max([trans1(i,2) trans2(i,2) trans3(i,2) ]);
end 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

psd_out=zeros(n,2);

gg=mpe(:,1);
bb=mpe(:,2);

for i=1:n
    
    ff=trans_max(i,1);
    aa=trans_max(i,2);
    [~,inx] = min(abs(ff-gg));
    psd_out(i,:)=[ff aa*bb(inx)];
    
end 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

FS='AM48_50_srs_max';
srs_in=evalin('base',FS);

srs_out=zeros(n,2);

gg=srs_in(:,1);
bb=srs_in(:,2);

for i=1:n
    
    ff=trans_max(i,1);
    aa=trans_max(i,2);
    aa=sqrt(aa);
    [~,inx] = min(abs(ff-gg));
    srs_out(i,:)=[ff aa*bb(inx)];
    
end 




